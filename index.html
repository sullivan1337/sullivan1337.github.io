<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>sullivan1337.github.io</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">  
  </head>
  
  <body>
    <header>
      <h1 class="header-left"><a href="https://github.com/sullivan1337/sullivan1337.github.io">sullivan1337.github.io</a></h1>
    </header>
    
    <nav>
      <div class="section">
        <h3 onclick="toggleSection('tech-tools')">Tech Tools <span id="tech-tools-toggle" class="toggle-symbol">-</span></h3>
        <div id="tech-tools" class="section-content">
          <button onclick="document.getElementById('content-frame').src='./tech-tools/g-toolbox/apps/har_analyzer/index.htm';">G-Toolbox (HAR)</button>
          <button onclick="window.open('./tech-tools/countdowns/index.html', '_blank');">
            Event Countdown <span class="new-tab-icon">ðŸ”—</span>
          </button>
          <button onclick="document.getElementById('content-frame').src='./tech-tools/terminal-tools/';">Terminal Tools & Scripts</button>
          <button onclick="document.getElementById('content-frame').src='./tech-tools/CyberChefv10.4/CyberChef_v10.4.0.html';">CyberChef</button>
          <button onclick="document.getElementById('content-frame').src='./tech-tools/webhook-generator/index.html';">Webhook Generator</button>
          <button onclick="document.getElementById('content-frame').src='./tech-tools/jwt-coder/index.html';">JWT Encoder/Decoder</button>
          <button onclick="document.getElementById('content-frame').src='./tech-tools/samlAnalysisHAR/index.html';">HAR SAML Analyzer</button>
        </div>
      </div>
      <div class="section">
        <h3 onclick="toggleSection('home-tools')">Home Tools <span id="home-tools-toggle" class="toggle-symbol">-</span></h3>
        <div id="home-tools" class="section-content">
          <button onclick="window.open('./home-tools/recipes/index.html', '_blank');">
            Cooking & Baking <span class="new-tab-icon">ðŸ”—</span>
          </button>
          <button onclick="document.getElementById('content-frame').src='./home-tools/gcal-mapit/index.html';">Gcal-mapit</button>
          <button onclick="document.getElementById('content-frame').src='./home-tools/Invoice-generator/index.html';">Invoice Generator</button>
          <button onclick="document.getElementById('content-frame').src='./home-tools/EvoScanBackup/index.htm';">EvoScan Backup</button>
          <button onclick="window.open('./home-tools/CarGarage/index.html', '_blank');">
            Current & Past Cars <span class="new-tab-icon">ðŸ”—</span>
          </button>
          <button onclick="window.open('./home-tools/DataLog1337/index.html', '_blank');">
            Tuning Log Viewer <span class="new-tab-icon">ðŸ”—</span>
          </button>
          <button onclick="document.getElementById('content-frame').src='./tech-tools/rackDesign/index.html';">Simple Rack Designer</button>
          <button onclick="document.getElementById('content-frame').src='./home-tools/FOV-Calc/';">Sim Rig FOV Calc</button>
        </div>
      </div>
    </nav>
    
    <main>
      <iframe id="content-frame" src="https://github.com/sullivan1337#user-profile-contributions" scrolling="yes"></iframe>
    </main>

    <footer>
      <div class="footer-info">
        <p>Latest Commits: <span id="lastCommits"></span> | Latest GitHub Actions: <span id="githubActions"></span></p>
      </div>
    </footer>

    <script>
      // Toggle visibility of sections
      function toggleSection(sectionId) {
        var sectionContent = document.getElementById(sectionId);
        var toggleIcon = document.getElementById(sectionId + '-toggle');
        if (sectionContent.style.display === "none" || sectionContent.style.display === "") {
          sectionContent.style.display = "block";
          toggleIcon.innerText = "-";
        } else {
          sectionContent.style.display = "none";
          toggleIcon.innerText = "+";
        }
      }

      // Set the GitHub API URL to fetch the last X commits
      var apiUrl = "https://api.github.com/repos/sullivan1337/sullivan1337.github.io/commits?per_page=1";

      // Use an AJAX request to get the last X commits from the GitHub API
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          var response = JSON.parse(this.responseText);
          var lastCommitElem = document.getElementById("lastCommits");
          if (response.length > 0) {
            var commit = response[0];
            var commitDate = new Date(commit.commit.author.date);
            var estDate = new Date(commitDate.toLocaleString("en-US", { timeZone: "America/New_York" }));
            var commitUrl = commit.html_url;
            var commitId = commit.sha;

            lastCommitElem.innerHTML = commit.commit.message + " (" + estDate.toLocaleString() + " EST) <a href='" + commitUrl + "' target='_blank'>" + commitId + "</a>";
          }
        }
      };
      xhttp.open("GET", apiUrl, true);
      xhttp.send();

      // Set the GitHub API URL for the GitHub Actions workflow runs
      var actionsApiUrl = "https://api.github.com/repos/sullivan1337/sullivan1337.github.io/actions/runs?per_page=1";
    
      // Use an AJAX request to get the last GitHub Actions workflow runs
      var actionsXhttp = new XMLHttpRequest();
      actionsXhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          var actionsResponse = JSON.parse(this.responseText);
          var runs = actionsResponse.workflow_runs;
          var actionsElem = document.getElementById("githubActions");
          if (runs.length > 0) {
            var run = runs[0];
            var status = run.status;
            var conclusion = run.conclusion ? `(${run.conclusion})` : "";
            actionsElem.innerHTML = "<a href='" + run.html_url + "' target='_blank'>" + run.name + " #" + run.run_number + "</a>" + " - " + status + " " + conclusion;
          }
        }
      };
      actionsXhttp.open("GET", actionsApiUrl, true);
      actionsXhttp.send();
    </script>

  </body>
</html>
